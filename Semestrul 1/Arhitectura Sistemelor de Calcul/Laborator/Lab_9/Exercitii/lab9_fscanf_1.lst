     1                                  bits 32
     2                                  global start
     3                                  
     4                                  extern exit, fopen, fclose, scanf, printf
     5                                  import exit msvcrt.dll
     6                                  import fopen msvcrt.dll
     7                                  import fclose msvcrt.dll
     8                                  import scanf msvcrt.dll
     9                                  import printf msvcrt.dll
    10                                  
    11                                  segment data use32 class=data
    12 00000000 746573742E74787400          nume_fisier db "test.txt", 0
    13 00000009 7700                        mod_acces db 'w', 0
    14 0000000B 00000000                    descriptor_fisier dd 0
    15                                      
    16 0000000F 45726F617265206C61-         mesaj db "Eroare la deschiderea fisierului"
    16 00000018 206465736368696465-
    16 00000021 726561206669736965-
    16 0000002A 72756C7569         
    17                                      
    18                                  segment code use32 class=code
    19                                      start:
    20                                          ; 1. deschid fisierul
    21                                          ; EAX - fopen(nume_fisier, mod_acces)
    22 00000000 68[09000000]                    push dword mod_acces
    23 00000005 68[00000000]                    push dword nume_fisier
    24 0000000A FF15[00000000]                  call [fopen]
    25 00000010 83C408                          add esp, 2*4
    26                                          
    27                                          ; 2. verific daca fisierul a fost deschis cu succes
    28 00000013 83F800                          cmp eax, 0
    29 00000016 7416                            je eroare
    30                                      
    31 00000018 A3[0B000000]                    mov [descriptor_fisier], eax
    32                                      
    33 0000001D FF35[0B000000]                  push dword [descriptor_fisier]
    34 00000023 FF15[00000000]                  call [fclose]
    35 00000029 83C404                          add esp, 1*4
    36 0000002C EB0F                            jmp final
    37                                          
    38                                          eroare:
    39 0000002E FF35[0F000000]                      push dword [mesaj]
    40 00000034 FF15[00000000]                      call [printf]
    41 0000003A 83C404                              add esp, 1*4
    42                                      final:
    43 0000003D 6A00                        push dword 0
    44 0000003F FF15[00000000]              call [exit]
