     1                                  ; Se da un fisier text. Sa se citeasca continutul fisierului, sa se determine cifra cu cea mai mare frecventa si sa se afiseze acea cifra impreuna cu frecventa acesteia. Numele fisierului text este definit in segmen
     2                                  bits 32
     3                                  global start
     4                                  
     5                                  extern exit, fopen, fread, scanf, printf, fclose
     6                                  import exit msvcrt.dll
     7                                  import fopen msvcrt.dll
     8                                  import fread msvcrt.dll
     9                                  import scanf msvcrt.dll
    10                                  import printf msvcrt.dll
    11                                  import fclose msvcrt.dll
    12                                  
    13                                  segment data use32 class=data
    14 00000000 6669736965722E7478-         nume_fisier db "fisier.txt", 0
    14 00000009 7400               
    15 0000000B FFFFFFFF                    descriptor_fisier dd -1
    16 0000000F 7200                        mod_acces db "r", 0
    17 00000011 436966726120256320-         format_afisare db "Cifra %c are frecventa %d", 0
    17 0000001A 617265206672656376-
    17 00000023 656E746120256400   
    18 0000002B 00000000                    caractere_citite dd 0
    19 0000002F 00000000                    cifra dd 0
    20 00000033 00000000                    contor dd 0
    21                                      sir_cifre equ 10
    22 00000037 <res 0000000A>              frecvente resb sir_cifre
    23                                      len equ 100
    24 00000041 00<rept>                    text times len db 0
    25                                      
    26                                  
    27                                  segment code use32 class=code
    28                                      start:
    29                                      
    30                                          ; deschidere fisier
    31 00000000 68[0F000000]                    push dword mod_acces
    32 00000005 68[00000000]                    push dword nume_fisier
    33 0000000A FF15[00000000]                  call [fopen]
    34 00000010 83C408                          add esp, 2*4
    35                                          
    36                                          ; verificare fisier
    37 00000013 A3[0B000000]                    mov [descriptor_fisier], eax
    38 00000018 83F800                          cmp eax, 0
    39 0000001B 0F8495000000                    je final
    40                                          
    41                                          repeta:
    42                                          
    43                                              ; citire fisier
    44 00000021 FF35[0B000000]                      push dword [descriptor_fisier]
    45 00000027 6A64                                push dword len
    46 00000029 6A01                                push dword 1
    47 0000002B 68[41000000]                        push dword text
    48 00000030 FF15[00000000]                      call [fread]
    49 00000036 83C410                              add esp, 4*4
    50                                              
    51 00000039 83F800                              cmp eax, 0
    52 0000003C 744F                                je inchidere_fisier
    53                                              
    54 0000003E A3[2B000000]                        mov [caractere_citite], eax
    55                                  
    56                                              ; parcurgerea caracterelor
    57 00000043 BE[41000000]                        mov esi, text
    58                                              
    59                                              verificare: 
    60                                              
    61 00000048 AC                                      lodsb
    62                                                  
    63 00000049 3C00                                    cmp al, 0
    64 0000004B 742E                                    je done
    65                                                  
    66 0000004D 3C30                                    cmp al, '0'
    67 0000004F 7CF7                                    jl verificare
    68                                                  
    69 00000051 3C39                                    cmp al, '9'
    70 00000053 7FF3                                    jg verificare
    71                                                  
    72 00000055 BA01000000                              mov edx, 1
    73 0000005A 0190[07000000]                          add [frecvente + eax - '0'], edx
    74 00000060 3898[07000000]                          cmp [frecvente + eax - '0'], bl
    75 00000066 7C11                                    jl next
    76 00000068 8B98[07000000]                          mov ebx, [frecvente + eax - '0']
    77 0000006E A3[2F000000]                            mov [cifra], eax
    78 00000073 881D[33000000]                          mov [contor], bl
    79                                                  
    80                                                  next:
    81 00000079 EBCD                                        jmp verificare
    82                                                      
    83                                                  done:
    84 0000007B 57                                          push edi
    85 0000007C BF[41000000]                                mov edi, text
    86 00000081 31C0                                        xor eax, eax
    87 00000083 B964000000                                  mov ecx, len
    88 00000088 F3AB                                        rep stosd
    89 0000008A 5F                                          pop edi
    90                                                  
    91 0000008B EB94                            jmp repeta
    92                                          
    93                                          inchidere_fisier:
    94                                          
    95                                              ; inchidem fisierul
    96 0000008D FF35[0B000000]                      push dword [descriptor_fisier]
    97 00000093 FF15[00000000]                      call [fclose]
    98 00000099 83C404                              add esp, 1*4
    99                                          
   100                                          afisare:
   101                                          ; afisam cifra si frecventa corespunzatoare
   102 0000009C FF35[33000000]                  push dword [contor]
   103 000000A2 FF35[2F000000]                  push dword [cifra]
   104 000000A8 68[11000000]                    push dword format_afisare
   105 000000AD FF15[00000000]                  call [printf]
   106 000000B3 83C40C                          add esp, 3 * 4
   107                                      
   108                                      final:
   109                                      
   110 000000B6 6A00                        push dword 0
   111 000000B8 FF15[00000000]              call [exit]
