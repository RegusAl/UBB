     1                                  bits 32
     2                                  global start
     3                                  
     4                                  extern exit
     5                                  import exit msvcrt.dll
     6                                  
     7                                  segment data use32 class=data
     8 00000000 5922163864041701F8          sir db 89, 34, 22, 56, 100, 4, 23, 1, -8
     9                                      len equ ($-sir)
    10 00000009 00                          over db 0
    11                                  
    12                                  segment code use32 class=code
    13                                      start:
    14                                          
    15                                          while_loop:
    16                                          
    17 00000000 B908000000                          mov ecx, len-1
    18 00000005 E325                                jecxz final_loop
    19                                          
    20 00000007 BE[00000000]                        mov esi, sir
    21 0000000C BF[01000000]                        mov edi, sir+1
    22 00000011 FC                                  cld
    23 00000012 C605[09000000]00                    mov byte [over], 0
    24                                              
    25                                              for_loop:
    26                                              
    27 00000019 A6                                      cmpsb
    28 0000001A 7C0E                                    jl final_if
    29                                                  
    30 0000001C 4E                                          dec(esi)
    31 0000001D 4F                                          dec(edi)
    32 0000001E AC                                          lodsb
    33 0000001F 4F                                          dec(edi)
    34 00000020 A4                                          movsb
    35 00000021 4E                                          dec(esi)
    36 00000022 AA                                          stosb
    37 00000023 C605[09000000]01                            mov byte [over], 1
    38                                                      
    39                                                  final_if:
    40                                              
    41 0000002A E2ED                                loop for_loop
    42                                          
    43                                          final_loop:
    44 0000002C 803D[09000000]00                    cmp byte [over], 0
    45 00000033 75CB                                jne while_loop
    46                                      
    47                                      
    48                                      
    49 00000035 6A00                        push dword 0
    50 00000037 FF15[00000000]              call [exit]
